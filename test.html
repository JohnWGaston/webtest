<!DOCTYPE html>
<html>
<body>
    <h1>Contact Lookup</h1>
    <select id="departmentSelect">
        <option value="Select">Select</option>
        <option value="Advancement Services">Advancement Services</option>
        <option value="Controllers Office">Controllers Office</option>
        <option value="Public Safety Services (UPD)">Public Safety Services (UPD)</option>
        <option value="Veterans Resource Center">Veterans Resource Center</option>
        <option value="Undergraduate Admissions">Undergraduate Admissions</option>
        <option value="Registrars Office">Registrars Office</option>
        <option value="Internal Audit">Internal Audit</option>
        <option value="Disbursements and Travel Services">Disbursements and Travel Services</option>
        <option value="Sam Houston Press and Copy Center">Sam Houston Press and Copy Center</option>
        <option value="Property Department">Property Department</option>
        <option value="Agricultural Sciences">Agricultural Sciences</option>
        <option value="BearKat OneCard Services">BearKat OneCard Services</option>
        <option value="Chemistry Department">Chemistry Department</option>
        <option value="College of Osteopathic Medicine">College of Osteopathic Medicine</option>
        <option value="Facilities Management">Facilities Management</option>
        <option value="Geography & Geology">Geography & Geology</option>
        <option value="Lowman Student Center">Lowman Student Center</option>
        <option value="Residence Life">Residence Life</option>
        <option value="Student Money Management Center ">Student Money Management Center </option>
        <option value="Receiving">Receiving</option>
        <option value="Academic Accounting">Academic Accounting</option>
        <option value="Banking">Banking</option>
        <option value="College of Business Administration">College of Business Administration</option>
        <option value="College of Health Sciences">College of Health Sciences</option>
        <option value="English Department">English Department</option>
        <option value="Graduate Studies">Graduate Studies</option>
        <option value="Library Science Department">Library Science Department</option>
        <option value="Newton Gresham Library">Newton Gresham Library</option>
        <option value="Presidents Office">Presidents Office</option>
        <option value="School of Nursing">School of Nursing</option>
        <option value="Art Department">Art Department</option>
        <option value="CMIT">CMIT</option>
        <option value="College of Crimal Justice">College of Crimal Justice</option>
        <option value="Dance Department">Dance Department</option>
        <option value="IT Client Services">IT Client Services</option>
        <option value="LEMIT">LEMIT</option>
        <option value="Mass Communications">Mass Communications</option>
        <option value="PI Delta (Grant)">PI Delta (Grant)</option>
        <option value="School of Music">School of Music</option>
        <option value="SHSU Online">SHSU Online</option>        
    </select>
    <div id="contactInfo">
        <p>Name: <span id="contactName"></span></p>
        <p>Email: <span id="contactEmail"></span></p>
    </div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
<script>
    // Event listener for the dropdown change event
    document.getElementById("departmentSelect").addEventListener("change", function () {
        // Get the selected department from the dropdown
        const selectedDepartment = this.value;

        // Use AJAX to load and parse the CSV file
        Papa.parse("test.csv", {
            download: true,
            header: true,
            skipEmptyLines: true,
            complete: function (results) {
                // Callback function to handle the parsed data
                handleData(results.data, selectedDepartment);
            }
        });
    });

    function handleData(contacts, selectedDepartment) {
        // Iterate through the CSV data to find the contact for the selected department
        const contact = contacts.find(item => item.Department === selectedDepartment);

        if (contact) {
            // Display the contact information
            document.getElementById("contactName").textContent = contact.Name;
            document.getElementById("contactEmail").textContent = contact.Email;
        } else {
            // Handle the case where no contact is found
            document.getElementById("contactName").textContent = "Contact not found";
            document.getElementById("contactEmail").textContent = "";
        }
    }
</script>
</body>
</html>
